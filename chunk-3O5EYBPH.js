import{F as s,L as i,V as v,Z as x}from"./chunk-MVAF4IQQ.js";var d={};function P(r,t,n){let e=2166136261;for(let o=0;o<t;o++)e^=r[o].uid,e=Math.imul(e,16777619),e>>>=0;return d[e]||h(r,t,e,n)}function h(r,t,n,e){let o={},c=0;for(let a=0;a<e;a++){let p=a<t?r[a]:i.EMPTY.source;o[c++]=p.source,o[c++]=p.style}let l=new x(o);return d[n]=l,l}var u=class{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,n){let e=v.get().createCanvas();e.width=t,e.height=n;let o=e.getContext("2d");return{canvas:e,context:o}}getOptimalCanvasAndContext(t,n,e=1){t=Math.ceil(t*e-1e-6),n=Math.ceil(n*e-1e-6),t=s(t),n=s(n);let o=(t<<17)+(n<<1);this._canvasPool[o]||(this._canvasPool[o]=[]);let c=this._canvasPool[o].pop();return c||(c=this._createCanvasAndContext(t,n)),c}returnCanvasAndContext(t){let n=t.canvas,{width:e,height:o}=n,c=(e<<17)+(o<<1);t.context.clearRect(0,0,e,o),this._canvasPool[c].push(t)}clear(){this._canvasPool={}}},w=new u;export{P as a,w as b};
